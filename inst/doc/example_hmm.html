<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Example: Hidden Markov Model</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Example: Hidden Markov Model</h1>



<p>In this vignette<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> we describe the workflow of the
<code>{ino}</code> package for fitting a hidden Markov model (HMM)
through likelihood optimization. HMMs are statistical models used to
explain systems that can only be observed indirectly through a sequence
of outputs, and have unobservable hidden states. They consist of two
processes, a Markov process that describes the hidden states, and an
observable process that describes the outputs produced by the system,
where the probability of observing an output at a given time depends
only on the current state. State-switching models like HMMs are commonly
used in speech recognition, animal movement modeling, bioinformatics,
and finance. For more technical details about HMMs and their scope of
application, see, e.g., <span class="citation">Zucchini, MacDonald, and
Langrock (<a href="#ref-Zucchini:2016" role="doc-biblioref">2016</a>)</span>.</p>
<div id="application-to-financial-data" class="section level2">
<h2>Application to financial data</h2>
<p>The example data set considered throughout this vignette covers a
time series of log returns from the <a href="https://en.wikipedia.org/wiki/DAX">German stock index DAX</a> over
30 years. The DAX closing prices are freely accessible via Yahoo Finance
and can be downloaded via the <code>download_data()</code> function from
the <code>{fHMM}</code> package <span class="citation">(<a href="#ref-Oelschläger:2023b" role="doc-biblioref">Oelschläger, Adam,
and Michels 2023</a>)</span>. They can easily be transformed to log
returns using the <code>{dplyr}</code> package <span class="citation">(<a href="#ref-Wickham:2023" role="doc-biblioref">Wickham et al. 2023</a>)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;fHMM&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>dax <span class="ot">&lt;-</span> <span class="fu">download_data</span>(<span class="at">symbol =</span> <span class="st">&quot;^GDAXI&quot;</span>, <span class="at">from =</span> <span class="st">&quot;1990-01-01&quot;</span>, <span class="at">to =</span> <span class="st">&quot;2020-01-01&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">logreturn =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(<span class="fu">log</span>(Close), <span class="at">lag =</span> <span class="dv">1</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(logreturn)) <span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 7,475 × 2</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    date       logreturn</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;date&gt;         &lt;dbl&gt;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 1990-01-03  0.0429  </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 1990-01-04 -0.0197  </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 1990-01-05 -0.00989 </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 1990-01-08  0.0156  </span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 1990-01-09  0.0130  </span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 1990-01-10 -0.0121  </span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 1990-01-11  0.000201</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 1990-01-12  0.00947 </span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 1990-01-15 -0.0111  </span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 1990-01-16 -0.0188  </span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 7,465 more rows</span></span></code></pre></div>
<p>The time series looks as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dax, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> logreturn)) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>() <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>())</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="75%" style="display: block; margin: auto;" /></p>
<p>As the log returns are continuous and can take both negative and
positive values, we consider an HMM with Gaussian state-dependent
distributions — note that some applications instead use t-distributions
to also model the kurtosis <span class="citation">(<a href="#ref-Oelschläger:2021" role="doc-biblioref">Oelschläger and Adam
2021</a>)</span>.</p>
</div>
<div id="likelihood-optimization" class="section level2">
<h2>Likelihood optimization</h2>
<p>We consider a 2-state (<code>N = 2</code>) Gaussian-HMM here to model
bearish and bullish market periods. This results in six parameters
(<code>npar = 6</code>) to be estimated:</p>
<ul>
<li>two identified parameters for the transition probability matrix
(t.p.m.),</li>
<li>two for the means of the state-dependent distributions,</li>
<li>two for the standard deviations of the state-dependent
distributions.</li>
</ul>
<p>The likelihood for a Gaussian-HMM is given by the function
<code>f_ll_hmm()</code> provided by the <code>{ino}</code> package. The
argument <code>neg = TRUE</code> indicates that we minimize the negative
log-likelihood, and <code>set_optimizer(optimizer_nlm())</code> selects
the optimizer <code>stats::nlm()</code> (see the introductory vignette
for more details on how to specify optimizers).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>hmm_ino <span class="ot">&lt;-</span> Nop<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">f =</span> f_ll_hmm, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">npar =</span> <span class="dv">6</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dax<span class="sc">$</span>logreturn, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="dv">2</span>, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">neg =</span> <span class="cn">TRUE</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set_optimizer</span>(<span class="fu">optimizer_nlm</span>())</span></code></pre></div>
<div id="random-initialization" class="section level3">
<h3>Random initialization</h3>
<p>Randomly chosen starting values is a first initialization
approach:</p>
<ul>
<li>As the first two starting values belong to the off-diagonal of the
t.p.m., we draw starting values from a <span class="math inline">\(\mathcal{U}(-2,-1)\)</span> distribution — as we
use the multinomial logit link to ensure that the probabilities are
between 0 and 1, a value of -1.5 correspond to probabilities of staying
in state 1 or 2 of about 80%.</li>
<li>For the two means, we draw two random numbers from the standard
normal distribution, as the time series above indicates that the most of
the returns are fairly close to zero.</li>
<li>The starting values for the standard deviations are drawn from a
<span class="math inline">\(\mathcal{U}(0.5,2)\)</span> distribution
(note that we exponentiate the standard deviations in the likelihood as
they are constrained to be positive, and hence we log-transform the
starting values).</li>
</ul>
<p>The <code>$optimize()</code> method with argument
<code>initial = sampler</code> then performs <code>runs = 100</code>
optimization runs with starting values drawn from the specified
distributions:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sampler <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(stats<span class="sc">::</span><span class="fu">runif</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>), stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">2</span>), <span class="fu">log</span>(stats<span class="sc">::</span><span class="fu">runif</span>(<span class="dv">2</span>, <span class="fl">0.5</span>, <span class="dv">2</span>)))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>hmm_ino<span class="sc">$</span><span class="fu">optimize</span>(<span class="at">initial =</span> sampler, <span class="at">runs =</span> <span class="dv">100</span>, <span class="at">label =</span> <span class="st">&quot;random&quot;</span>)</span></code></pre></div>
</div>
<div id="educated-guesses" class="section level3">
<h3>Educated guesses</h3>
<p>For selecting fixed starting values, we consider sets of starting
values that fall in the ranges considered above. These can be considered
as “educated guesses” and are likely to be close to the global
optimum:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tpm_entry_1 <span class="ot">&lt;-</span> tpm_entry_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">2.5</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mu_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.05</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>mu_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>sd_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">0.1</span>), <span class="fu">log</span>(<span class="fl">0.5</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>sd_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">0.75</span>), <span class="fu">log</span>(<span class="dv">1</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>starting_values <span class="ot">&lt;-</span> <span class="fu">asplit</span>(<span class="fu">expand.grid</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  tpm_entry_1, tpm_entry_2, mu_1, mu_2, sd_1, sd_2), </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">MARGIN =</span> <span class="dv">1</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>This grid results in a total of 64 starting values, which can be
specified as the <code>initial</code> argument:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>hmm_ino<span class="sc">$</span><span class="fu">optimize</span>(<span class="at">initial =</span> starting_values, <span class="at">label =</span> <span class="st">&quot;educated_guess&quot;</span>)</span></code></pre></div>
</div>
<div id="subset-initialization" class="section level3">
<h3>Subset initialization</h3>
<p>Since the data set is large, containing a total of 7475 share return
observations, it might be beneficial to obtain initial values by first
fitting the model to a data subset. If the data subset is chosen small
enough, estimation with the subset will be much faster. On the other
hand, if the data subset is chosen large enough to still contain enough
information, the estimates on the subset will already lie close to the
estimates for the full model.</p>
<p>To illustrate the subset initialization strategy, we consider the
first quarter of observations, which can be extracted using the
<code>$reduce()</code> method with arguments <code>how = &quot;first&quot;</code>
and <code>prop = 0.25</code>. The starting values for the optimizations
on this subset are drawn from the <code>sampler()</code> function
defined above. We again use <code>$optimize()</code> to fit the HMM, but
now to the data subset. With <code>$continue()</code>, we then use the
estimates obtained from the optimization on the subset as initial values
to fit the model to the entire data set. The entire data set is restored
via <code>$reset_argument(&quot;data&quot;)</code>.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>hmm_ino<span class="sc">$</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(<span class="st">&quot;data&quot;</span>, <span class="at">how =</span> <span class="st">&quot;first&quot;</span>, <span class="at">prop =</span> <span class="fl">0.25</span>)<span class="sc">$</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">optimize</span>(<span class="at">initial =</span> sampler, <span class="at">runs =</span> <span class="dv">100</span>, <span class="at">label =</span> <span class="st">&quot;subset&quot;</span>)<span class="sc">$</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reset_argument</span>(<span class="st">&quot;data&quot;</span>)<span class="sc">$</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">continue</span>()</span></code></pre></div>
</div>
</div>
<div id="standardize-initialization" class="section level2">
<h2>Standardize initialization</h2>
<p>The considered log returns range from -0.1 to 0.1. Optimization might
be facilitated by standardizing the data first. This idea can be tested
via the <code>$standardize()</code> method:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>hmm_ino<span class="sc">$</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">standardize</span>(<span class="st">&quot;data&quot;</span>)<span class="sc">$</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">optimize</span>(<span class="at">initial =</span> sampler, <span class="at">runs =</span> <span class="dv">100</span>, <span class="at">label =</span> <span class="st">&quot;standardize&quot;</span>)<span class="sc">$</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reset_argument</span>(<span class="st">&quot;data&quot;</span>)</span></code></pre></div>
<p>Note that we again use <code>$reset_argument()</code> to obtain our
actual (non-standardized) data set.</p>
</div>
<div id="evaluating-the-optimization-runs" class="section level2">
<h2>Evaluating the optimization runs</h2>
<div id="global-versus-local-optima" class="section level3">
<h3>Global versus local optima</h3>
<p>Selecting the starting values for the HMM likelihood optimization is
a well-known issue, as poor starting values may likely result in local
optima.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
We thus first evaluate the optimizations by comparing the likelihood
values at convergence, which can be displayed using the
<code>$optima()</code> method. Here,</p>
<ul>
<li><code>sort_by = &quot;value&quot;</code> sorts the table by function value (in
decreasing order<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>),</li>
<li><code>only_comparable = TRUE</code> excludes optimization results on
the standardized or reduced data set,</li>
<li><code>digitis = 0</code> ignores any decimal places.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>hmm_ino<span class="sc">$</span><span class="fu">optima</span>(<span class="at">sort_by =</span> <span class="st">&quot;value&quot;</span>, <span class="at">only_comparable =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    value frequency</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 -22446        76</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 -22445        40</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 -21780         3</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 -21372       144</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 -21353         1</span></span></code></pre></div>
<p>The frequency table indicates that 76 out of 264 runs converged to
the smallest (negative) log-likelihood value, which appears to be the
global optimum (note that these are the negative log-likelihood values).
However, in 188 runs we apparantly got stuck in local optima.</p>
<p>Using <code>summary()</code>, we now can investigate the optimum
values (<code>&quot;value&quot;</code>), the corresponding parameter vectors
(<code>&quot;parameter&quot;</code>), and the optimization times
(<code>&quot;seconds&quot;</code>) of all runs (here, only the first ten are
shown):<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hmm_ino, <span class="at">which_element =</span> <span class="fu">c</span>(<span class="st">&quot;value&quot;</span>, <span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;seconds&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        value                                 parameter seconds</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  -21372.14  -2.05, -18.88, 0.00, -2.35, -4.28, -4.64   12.81</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  -22445.58    -3.70, -4.52, 0.00, 0.00, -4.72, -3.86   14.84</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  -21372.14   -15.59, -2.08, 5.06, 0.00, -7.44, -4.28    9.57</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  -22445.58    -3.70, -4.52, 0.00, 0.00, -4.72, -3.86   20.73</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  -22445.58    -4.52, -3.70, 0.00, 0.00, -3.86, -4.72   21.37</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  -21352.70 -15.92, -35.48, 14.12, 0.00, -8.09, -4.28   18.44</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  -22445.58    -4.52, -3.70, 0.00, 0.00, -3.86, -4.72   32.38</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  -21372.14 -30.36, -3.62, -22.03, 0.00, -4.71, -4.28   24.00</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9  -21372.13  -2.88, -13.94, 0.00, 1.46, -4.28, -12.26    8.39</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 -22445.58    -3.70, -4.52, 0.00, 0.00, -4.72, -3.86   23.36</span></span></code></pre></div>
<p>The final parameter estimates (i.e., the parameters associated with
the global optimum) can be accessed via <code>$best_parameter()</code>
…</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>hmm_ino<span class="sc">$</span><span class="fu">best_parameter</span>()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -3.70 -4.52  0.00  0.00 -4.72 -3.86</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;run&quot;)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 89</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;optimizer&quot;)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;stats::nlm&quot;</span></span></code></pre></div>
<p>.. and the corresponding likelihood value as:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>hmm_ino<span class="sc">$</span><span class="fu">best_value</span>()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -22445.58</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;run&quot;)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 89</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;optimizer&quot;)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;stats::nlm&quot;</span></span></code></pre></div>
<p>Note that the attributes <code>&quot;run&quot;</code> and
<code>&quot;optimizer&quot;</code> provide the information, in which optimization
run and with which optimizer this estimate was obtained.</p>
<p>We can compute the proportion of runs that lead to the apparent
global optimum of -22445.58 as follows:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hmm_ino, <span class="fu">c</span>(<span class="st">&quot;label&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="st">&quot;seconds&quot;</span>), <span class="at">global_optimum =</span> <span class="st">&quot;value &lt; -22445&quot;</span>, <span class="at">only_comparable =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(label) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">proportion =</span> <span class="fu">mean</span>(global_optimum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   label          proportion</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;               &lt;dbl&gt;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 educated_guess      0.562</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 random              0.4  </span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 subset              0.4</span></span></code></pre></div>
<p>While for the educated guesses about 55% of the runs converge to the
global optimum, the random initialization and subset initialization
strategies get stuck more often in local optima. Note that the
standardized initialization approach cannot be compared to the other
approaches here.</p>
</div>
<div id="optimization-time" class="section level3">
<h3>Optimization time</h3>
<p>The <code>plot()</code> function can be used to investigate the
optimization times across initialization strategies
(<code>by = &quot;label&quot;</code>).<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hmm_ino, <span class="at">by =</span> <span class="st">&quot;label&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="75%" style="display: block; margin: auto;" /></p>
<p>Using the output provided by <code>summary()</code> and some data
manipulation functions provided by the package <code>{dplyr}</code>, we
can also compute summary statistics of interest, like the median
computation time or standard deviation per strategy:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hmm_ino, <span class="fu">c</span>(<span class="st">&quot;label&quot;</span>, <span class="st">&quot;seconds&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(label) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_seconds =</span> <span class="fu">median</span>(seconds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_seconds =</span> <span class="fu">sd</span>(seconds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(median_seconds)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   label          median_seconds sd_seconds</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                   &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 subset                   8.37       6.16</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 standardize              9.85       1.48</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 educated_guess          14.8        7.28</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 random                  15.9        7.30</span></span></code></pre></div>
<p>The subset and the standardize approach can improve the median
optimization time by a factor of about 2 in this example compared to the
random initialization approach.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Michelot:2016" class="csl-entry">
Michelot, T., R. Langrock, and T. A. Patterson. 2016. <span>“<span class="nocase">moveHMM</span>: An <span>R</span> Package for the
Statistical Modelling of Animal Movement Data Using Hidden Markov
Models.”</span> <em>Methods in Ecology and Evolution</em> 7 (11):
1308–15. <a href="https://doi.org/10.1111/2041-210X.12578">https://doi.org/10.1111/2041-210X.12578</a>.
</div>
<div id="ref-Oelschläger:2021" class="csl-entry">
Oelschläger, L., and T. Adam. 2021. <span>“Detecting Bearish and Bullish
Markets in Financial Time Series Using Hierarchical Hidden Markov
Models.”</span> <em>Statistical Modelling</em>. <a href="https://doi.org/10.1177/1471082X211034048">https://doi.org/10.1177/1471082X211034048</a>.
</div>
<div id="ref-Oelschläger:2023b" class="csl-entry">
Oelschläger, L., T. Adam, and R. Michels. 2023. <em>fHMM: Fitting Hidden
Markov Models to Financial Data</em>. <a href="https://loelschlaeger.de/fHMM/">https://loelschlaeger.de/fHMM/</a>.
</div>
<div id="ref-Wickham:2023" class="csl-entry">
Wickham, H., R. François, L. Henry, K. Müller, and D. Vaughan. 2023.
<em><span class="nocase">dplyr</span>: A Grammar of Data
Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-Zucchini:2016" class="csl-entry">
Zucchini, W., I. L. MacDonald, and R. Langrock. 2016. <em>Hidden
<span>Markov Models</span> for <span>Time Series</span>: <span>An
Introduction</span> <span>U</span>sing <span>R</span></em>. Boca Raton:
Chapman &amp; Hall/CRC.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>The vignette was build using R 4.2.2 with the
<code>{ino}</code> 1.0.0 package.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>If we were to skip the <code>$reset_argument()</code>
step, all future optimization runs would be made on the subset.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Other R packages designed to fit HMMs discuss this topic
in more detail, see, e.g., <span class="citation">Michelot, Langrock,
and Patterson (<a href="#ref-Michelot:2016" role="doc-biblioref">2016</a>)</span>.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>By default, optimization is assumed to involve
minimizing the target function. If instead the function is maximized,
set <code>hmm_ino$minimized &lt;- FALSE</code> to reverse the ordering
in the <code>$optima()</code> output.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>The <code>$elements_available()</code> method provides
an overview of all available optimization result elements.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Setting <code>relative = FALSE</code> in the
<code>plot()</code> call shows the absolute times.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
