<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Package demo: Hidden Markov Model</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Package demo: Hidden Markov Model</h1>



<p>HMMs are statistical models used to explain systems that can only be
observed indirectly through a sequence of outputs, and have unobservable
hidden states. They consist of two processes,</p>
<ol style="list-style-type: decimal">
<li><p>a Markov process that describes the hidden states, and</p></li>
<li><p>an observable process that describes the outputs produced by the
system, where the probability of observing an output at a given time
depends only on the current state.</p></li>
</ol>
<p>State-switching models like HMMs are commonly used in speech
recognition, animal movement modeling, and finance. For more technical
details about HMMs and their scope of application, see <span class="citation">Zucchini, MacDonald, and Langrock (<a href="#ref-Zucchini:2016">2016</a>)</span>.</p>
<p>Numerical likelihood optimization is a prominent method for fitting
HMMs to empirical data. In this vignette we describe the workflow of
using the <code>{ino}</code> package for analyzing the initialization
effect in this optimization task.</p>
<div id="application-to-financial-data" class="section level2">
<h2>Application to financial data</h2>
<p>The example data set considered throughout this vignette covers a
time series of log returns from the <a href="https://en.wikipedia.org/wiki/DAX">German stock index DAX</a> over
30 years. The DAX closing prices are freely accessible via <a href="https://finance.yahoo.com">Yahoo Finance</a> and can be downloaded
via the <code>download_data()</code> function from the
<code>{fHMM}</code> package <span class="citation">(<a href="#ref-Oelschlaeger:2024">Oelschläger, Adam, and Michels
2024</a>)</span>. We transform them to log-returns using the
<code>{dplyr}</code> package <span class="citation">(<a href="#ref-Wickham:2023">Wickham et al. 2023</a>)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;fHMM&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>dax <span class="ot">&lt;-</span> <span class="fu">download_data</span>(<span class="at">symbol =</span> <span class="st">&quot;^GDAXI&quot;</span>, <span class="at">from =</span> <span class="st">&quot;1990-01-01&quot;</span>, <span class="at">to =</span> <span class="st">&quot;2020-01-01&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    <span class="at">logreturn =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(<span class="fu">log</span>(Close), <span class="at">lag =</span> <span class="dv">1</span>))</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(logreturn)) <span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; # A tibble: 7,475 × 2</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt;    date       logreturn</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt;    &lt;date&gt;         &lt;dbl&gt;</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt;  1 1990-01-03  0.0429  </span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt;  2 1990-01-04 -0.0197  </span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt;  3 1990-01-05 -0.00989 </span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt;  4 1990-01-08  0.0156  </span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt;  5 1990-01-09  0.0130  </span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt;  6 1990-01-10 -0.0121  </span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt;  7 1990-01-11  0.000201</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt;  8 1990-01-12  0.00947 </span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co">#&gt;  9 1990-01-15 -0.0111  </span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co">#&gt; 10 1990-01-16 -0.0188  </span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="co">#&gt; # ℹ 7,465 more rows</span></span></code></pre></div>
<p>The time series looks as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">ggplot</span>(dax, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> logreturn)) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="fu">scale_x_date</span>() <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>())</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="75%" style="display: block; margin: auto;" /></p>
<p>As the log-returns are continuous and can take both negative and
positive values, we consider an HMM with Gaussian state-dependent
distributions — note that some applications instead use t-distributions
to also model the kurtosis <span class="citation">(<a href="#ref-Oelschlaeger:2021">Oelschläger and Adam 2021</a>)</span>.</p>
</div>
<div id="likelihood-optimization" class="section level2">
<h2>Likelihood optimization</h2>
<p>We consider a 2-state (<code>states = 2</code>) Gaussian-HMM
(<code>sdds = &quot;normal&quot;</code>) here to model bearish and bullish market
periods. This results in six parameters (<code>npar = 6</code>) to be
estimated (to be optimized, respectively):</p>
<ul>
<li>two identified parameters for the transition probability
matrix,</li>
<li>two for the means of the state-dependent distributions,</li>
<li>two for the standard deviations of the state-dependent
distributions.</li>
</ul>
<p>The likelihood function <code>ll_hmm()</code> is provided by the
<code>{fHMM}</code> package. The argument <code>negative = TRUE</code>
indicates that we minimize the negative log-likelihood.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ino&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>Nop_hmm <span class="ot">&lt;-</span> Nop<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">f =</span> fHMM<span class="sc">::</span>ll_hmm, </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">npar =</span> <span class="dv">6</span>, </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">observations =</span> dax<span class="sc">$</span>logreturn,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">sdds =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">states =</span> <span class="dv">2</span>, </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">negative =</span> <span class="cn">TRUE</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>)</span></code></pre></div>
<p>In this example, we optimize using the optimizer
<code>stats::nlm()</code> (see the introductory vignette for more
details on how to specify optimizers):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span><span class="fu">set_optimizer</span>(optimizeR<span class="sc">::</span>Optimizer<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;stats::nlm&quot;</span>))</span></code></pre></div>
<div id="parallel-optimization-and-progress-updates" class="section level3">
<h3>Parallel optimization and progress updates</h3>
<p>For convenience, The <code>{ino}</code> package supports parallel
computation of optimization runs based on the <code>{future}</code>
package <span class="citation">(<a href="#ref-Bengtsson:2021">Bengtsson
2021</a>)</span> and printing progress messages based on the
<code>{progressr}</code> package <span class="citation">(<a href="#ref-Bengtsson:2024">Bengtsson 2024</a>)</span>.</p>
<p>For example, calling</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>future<span class="sc">::</span><span class="fu">plan</span>(future<span class="sc">::</span>multisession, <span class="at">workers =</span> <span class="dv">10</span>)</span></code></pre></div>
<p>uses parallel computation in 10 parallel R sessions, and calling</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>progressr<span class="sc">::</span><span class="fu">handlers</span>(<span class="at">global =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>prints a progress bar.</p>
</div>
<div id="random-initialization" class="section level3">
<h3>Random initialization</h3>
<p>Choosing random starting values is a first naive initialization
approach, which can be tested as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">initialize_random</span>(<span class="at">runs =</span> <span class="dv">100</span>)<span class="sc">$</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">optimize</span>(<span class="at">optimization_label =</span> <span class="st">&quot;random_naive&quot;</span>)</span></code></pre></div>
<p>The method <code>$initialize_random()</code> selects
<code>runs = 100</code> random initial values, which are drawn from a
standard normal distribution by default. Next, the
<code>$optimize()</code> method initiates optimization of the likelihood
function starting from these values. The results are labeled as
<code>&quot;random_naive&quot;</code> to facilitate comparison later.</p>
<p>Instead of drawing initial values from a standard normal
distribution, users can define a custom sampler function, for
example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>sampler <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="fu">c</span>(stats<span class="sc">::</span><span class="fu">runif</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>), stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">2</span>), <span class="fu">log</span>(stats<span class="sc">::</span><span class="fu">runif</span>(<span class="dv">2</span>, <span class="fl">0.5</span>, <span class="dv">2</span>)))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>}</span></code></pre></div>
<p>This sampler is based on the following ideas:</p>
<ul>
<li>As the first two starting values belong to the off-diagonal of the
transition probability matrix, we draw starting values from a <span class="math inline">\(\mathcal{U}(-2,-1)\)</span> distribution — the
likelihood function uses the multinomial logit link to ensure that the
probabilities are between <span class="math inline">\(0\)</span> and
<span class="math inline">\(1\)</span>, a value of <span class="math inline">\(-1.5\)</span> correspond to probabilities of
staying in state 1 or 2 of about <span class="math inline">\(80\%\)</span>.</li>
<li>For the two means, we draw two random numbers from the standard
normal distribution, as the time series above indicates that the
log-returns vary around zero.</li>
<li>The starting values for the standard deviations are drawn from a
<span class="math inline">\(\mathcal{U}(0.5,2)\)</span> distribution
(note that the likelihood function exponentiates the standard deviations
as they are constrained to be positive, and hence we log-transform the
starting values).</li>
</ul>
<p>The <code>optimize()</code> method then performs
<code>runs = 100</code> optimizations with starting values drawn from
the specified distributions:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">initialize_random</span>(<span class="at">sampler =</span> sampler, <span class="at">runs =</span> <span class="dv">100</span>)<span class="sc">$</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">optimize</span>(<span class="at">optimization_label =</span> <span class="st">&quot;random&quot;</span>)</span></code></pre></div>
</div>
<div id="grid-initialization-with-educated-guesses" class="section level3">
<h3>Grid initialization with educated guesses</h3>
<p>Another initialization strategy that closely relates to specifying a
custom sampler for the initial values is to make “educated guesses” and
to consider a grid of these values as initialization. This can be
implemented via the <code>$initialize_grid()</code> method, where and
<code>lower</code> and <code>upper</code> limits and <code>breaks</code>
can be specified. Here, we consider a grid of 64 starting values that
fall in the ranges considered above:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">initialize_grid</span>(</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="fu">log</span>(<span class="fl">0.1</span>), <span class="fu">log</span>(<span class="fl">0.1</span>)),</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fu">log</span>(<span class="dv">1</span>), <span class="fu">log</span>(<span class="dv">1</span>)),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">2</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  )<span class="sc">$</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="fu">optimize</span>(<span class="at">optimization_label =</span> <span class="st">&quot;educated_guess&quot;</span>)</span></code></pre></div>
</div>
<div id="subset-initialization" class="section level3">
<h3>Subset initialization</h3>
<p>Since the data set is large, containing a total of 7475 log-return
observations, it might be beneficial to obtain initial values by first
fitting the model to a data subset. If the data subset is chosen small
enough, estimation with the subset will be much faster. On the other
hand, if the data subset is chosen large enough to still contain enough
information, the estimates on the subset will already lie close to the
estimates for the full model and provide good initial values for the
full optimization.</p>
<p>To illustrate the subset initialization strategy, we consider the
first quarter of observations, which can be extracted using the
<code>$reduce_argument()</code> method with arguments
<code>how = &quot;first&quot;</code> and <code>proportion = 0.25</code>. The
starting values for the optimizations on this subset are drawn from the
<code>sampler()</code> function defined above. We again use
<code>$optimize()</code> to fit the HMM, but now to the data subset.
With <code>$initialize_continue()</code>, we then use the estimates
obtained from the optimization on the subset as initial values to fit
the model to the entire data set.</p>
<p>Finally, the entire data set is recovered via
<code>$fixed_argument(&quot;reset&quot;, argument_name = &quot;observations&quot;)</code>.
If we were to skip this step, all future optimization runs would be made
on the subset.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">reduce_argument</span>(<span class="st">&quot;observations&quot;</span>, <span class="at">how =</span> <span class="st">&quot;first&quot;</span>, <span class="at">proportion =</span> <span class="fl">0.25</span>)<span class="sc">$</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">initialize_random</span>(<span class="at">sampler =</span> sampler, <span class="at">runs =</span> <span class="dv">100</span>)<span class="sc">$</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">optimize</span>(<span class="at">optimization_label =</span> <span class="st">&quot;reduced&quot;</span>)<span class="sc">$</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="fu">fixed_argument</span>(<span class="st">&quot;reset&quot;</span>, <span class="at">argument_name =</span> <span class="st">&quot;observations&quot;</span>)<span class="sc">$</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="fu">initialize_continue</span>(<span class="st">&quot;reduced&quot;</span>)<span class="sc">$</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="fu">optimize</span>(<span class="at">optimization_label =</span> <span class="st">&quot;initialized_reduced&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="standardize-initialization" class="section level2">
<h2>Standardize initialization</h2>
<p>The considered log-returns range from -0.1 to 0.1. Optimization might
be facilitated by standardizing the data first. This idea can be tested
via the <code>$standardize_argument()</code> method:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span><span class="fu">standardize_argument</span>(<span class="st">&quot;observations&quot;</span>)</span></code></pre></div>
<p>The values used for the standardization can be extracted as
follows:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>observations <span class="ot">&lt;-</span> Nop_hmm<span class="sc">$</span><span class="fu">fixed_argument</span>(<span class="st">&quot;get&quot;</span>, <span class="at">argument_name =</span> <span class="st">&quot;observations&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>(center <span class="ot">&lt;-</span> <span class="fu">attr</span>(observations, <span class="st">&quot;center&quot;</span>))</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>(scale <span class="ot">&lt;-</span> <span class="fu">attr</span>(observations, <span class="st">&quot;scale&quot;</span>))</span></code></pre></div>
<p>Optimization proceeds as usual:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">initialize_random</span>(<span class="at">sampler =</span> sampler, <span class="at">runs =</span> <span class="dv">100</span>)<span class="sc">$</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="fu">optimize</span>(<span class="at">optimization_label =</span> <span class="st">&quot;standardized&quot;</span>)<span class="sc">$</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="fu">fixed_argument</span>(<span class="at">action =</span> <span class="st">&quot;reset&quot;</span>, <span class="at">argument_name =</span> <span class="st">&quot;observations&quot;</span>)</span></code></pre></div>
<p>Note that the results obtained on the standardized optimization
problem could be back-transformed via:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>transform <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">c</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], x[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">*</span> scale <span class="sc">+</span> center, <span class="fu">log</span>(<span class="fu">exp</span>(x[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">*</span> scale <span class="sc">+</span> center))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="evaluating-the-optimization-runs" class="section level2">
<h2>Evaluating the optimization runs</h2>
<div id="global-versus-local-optima" class="section level3">
<h3>Global versus local optima</h3>
<p>Selecting the starting values for the HMM likelihood optimization is
a well-known issue, as poor starting values may likely result in local
optima. We thus first evaluate the optimizations by comparing the
likelihood values at convergence, which can be displayed using the
<code>$optima()</code> method. Here,</p>
<ul>
<li><code>sort_by = &quot;value&quot;</code> sorts the table by function
value,</li>
<li><code>digitis = 0</code> ignores any decimal places.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span><span class="fu">optima</span>(<span class="at">sort_by_value =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 12 × 2</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt;     value     n</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt;  *  &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt;  1 -22446   168</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt;  2 -22445    37</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt;  3 -21804     2</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt;  4 -21803     1</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt;  5 -21423    22</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt;  6 -21421     1</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt;  7 -21372   128</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt;  8 -21371     1</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt;  9 -21351     1</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; 10 -21349     1</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt; 11 -21295     1</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt; 12  41293     1</span></span></code></pre></div>
<p>The frequency table indicates that 168 out of 364 runs converged to
the smallest (negative) log-likelihood value, which appears to be the
global optimum (note that these are the negative log-likelihood values).
However, in 196 runs we apparently got stuck in local optima.</p>
<p>Using <code>$results</code>, we now can investigate the optimum
values (<code>&quot;value&quot;</code>), the corresponding parameter vectors
(<code>&quot;parameter&quot;</code>), and the optimization times
(<code>&quot;seconds&quot;</code>) of all runs (here, only the first are
shown):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span>results <span class="sc">|&gt;</span> <span class="fu">select</span>(value, parameter, seconds)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 564 × 3</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt;      value parameter seconds</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;list&gt;      &lt;dbl&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt;  1 -22446. &lt;dbl [6]&gt;   0.682</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt;  2 -22446. &lt;dbl [6]&gt;   0.570</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt;  3 -22446. &lt;dbl [6]&gt;   0.439</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt;  4 -22446. &lt;dbl [6]&gt;   0.583</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt;  5 -22446. &lt;dbl [6]&gt;   0.470</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt;  6 -21372. &lt;dbl [6]&gt;   0.298</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt;  7 -22446. &lt;dbl [6]&gt;   0.411</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt;  8 -22446. &lt;dbl [6]&gt;   0.462</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt;  9 -21372. &lt;dbl [6]&gt;   0.327</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; 10 -21372. &lt;dbl [6]&gt;   0.344</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; # ℹ 554 more rows</span></span></code></pre></div>
<p>The final parameter estimates can be accessed:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span>minimum</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; $value</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; [1] -22445.58</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; $parameter</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; [1] -3.7009455944 -4.5228904822  0.0008467132 -0.0012013768 -4.7213010302</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; [6] -3.8587575292</span></span></code></pre></div>
<p>Next, we can compute the proportion of runs that lead to the apparent
global optimum as follows (note that the standardized initialization
approach cannot be compared to the other approaches here and is filtered
via the <code>.original</code> identifier):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span>results <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">filter</span>(.original) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">global_optimum =</span> value <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">22445</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">group_by</span>(.optimization_label) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">proportion =</span> <span class="fu">mean</span>(global_optimum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 2</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt;   .optimization_label proportion</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                    &lt;dbl&gt;</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; 1 educated_guess           0.891</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt; 2 initialized_reduced      0.37 </span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; 3 random                   0.47 </span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; 4 random_naive             0.64</span></span></code></pre></div>
</div>
<div id="optimization-time" class="section level3">
<h3>Optimization time</h3>
<p>The <code>autoplot()</code> method can be used to investigate the
optimization times across initialization strategies by setting
<code>group_by = &quot;optimization&quot;</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span>results <span class="sc">|&gt;</span> <span class="fu">autoplot</span>(<span class="at">group_by =</span> <span class="st">&quot;optimization&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="75%" style="display: block; margin: auto;" /></p>
<p>We can also compute summary statistics of interest, like the median
computation time or standard deviation per strategy:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>Nop_hmm<span class="sc">$</span>results <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="fu">group_by</span>(.optimization_label) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>    <span class="at">median_seconds =</span> <span class="fu">median</span>(seconds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>    <span class="at">sd_seconds =</span> <span class="fu">sd</span>(seconds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="fu">arrange</span>(median_seconds)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt;   .optimization_label median_seconds sd_seconds</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                        &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; 1 standardized                 0.296      0.115</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt; 2 reduced                      0.317      0.165</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt; 3 initialized_reduced          0.438      0.266</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co">#&gt; 4 random                       0.579      0.325</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt; 5 random_naive                 0.614      0.229</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt; 6 educated_guess               0.897      0.367</span></span></code></pre></div>
<p>The subset and the standardize approach can improve the median
optimization time by a factor of about 2 in this example compared to the
random initialization approach. Standardization also reduces standard
deviation in computation time, indicating more stable optimization.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Bengtsson:2021" class="csl-entry">
Bengtsson, H. 2021. <span>“A Unifying Framework for Parallel and
Distributed Processing in <span>R</span> Using Futures.”</span> <em>The
R Journal</em> 13 (2): 208–27. <a href="https://doi.org/10.32614/RJ-2021-048">https://doi.org/10.32614/RJ-2021-048</a>.
</div>
<div id="ref-Bengtsson:2024" class="csl-entry">
———. 2024. <em>Progressr: An Inclusive, Unifying API for Progress
Updates</em>. <a href="https://CRAN.R-project.org/package=progressr">https://CRAN.R-project.org/package=progressr</a>.
</div>
<div id="ref-Oelschlaeger:2021" class="csl-entry">
Oelschläger, L., and T. Adam. 2021. <span>“Detecting Bearish and Bullish
Markets in Financial Time Series Using Hierarchical Hidden Markov
Models.”</span> <em>Statistical Modelling</em>. <a href="https://doi.org/10.1177/1471082X211034048">https://doi.org/10.1177/1471082X211034048</a>.
</div>
<div id="ref-Oelschlaeger:2024" class="csl-entry">
Oelschläger, L., T. Adam, and R. Michels. 2024. <span>“<span class="nocase">fHMM: Hidden Markov Models for Financial Time Series in
R</span>.”</span> <em>Journal of Statistical Software</em> 109 (9). <a href="https://doi.org/10.18637/jss.v109.i09">https://doi.org/10.18637/jss.v109.i09</a>.
</div>
<div id="ref-Wickham:2023" class="csl-entry">
Wickham, H., R. François, L. Henry, K. Müller, and D. Vaughan. 2023.
<em><span class="nocase">dplyr</span>: A Grammar of Data
Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-Zucchini:2016" class="csl-entry">
Zucchini, W., I. L. MacDonald, and R. Langrock. 2016. <em>Hidden
<span>Markov Models</span> for <span>Time Series</span>: <span>An
Introduction</span> <span>U</span>sing <span>R</span></em>. Boca Raton:
Chapman &amp; Hall/CRC.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
